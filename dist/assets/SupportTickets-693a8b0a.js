import{r as c,a as w,s as p,j as e,m as b,B as o}from"./index-b4b9cf58.js";import{C as x}from"./clock-e5ab6bdb.js";import{C as g}from"./check-circle-f980e3c6.js";import{X as h}from"./x-circle-e4edbbdb.js";import{M as f}from"./message-square-134b03e9.js";const z=()=>{const[l,n]=c.useState([]),[j,d]=c.useState(!0),{toast:r}=w();c.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:s,error:t}=await p.from("support_tickets").select(`
          *,
          user:user_id(name, email)
        `).order("created_at",{ascending:!1});if(t)throw t;n(s),d(!1)}catch{r({variant:"destructive",title:"Error",description:"Failed to load support tickets"}),d(!1)}},a=async(s,t)=>{try{const{data:i,error:u}=await p.from("support_tickets").update({status:t}).eq("id",s).select().single();if(u)throw u;n(l.map(m=>m.id===s?i:m)),r({title:"Success",description:"Ticket status updated successfully"})}catch(i){r({variant:"destructive",title:"Error",description:i.message})}},y=s=>{switch(s){case"open":return"bg-yellow-100 text-yellow-600";case"in_progress":return"bg-blue-100 text-blue-600";case"resolved":return"bg-green-100 text-green-600";case"closed":return"bg-gray-100 text-gray-600";default:return"bg-gray-100 text-gray-600"}},N=s=>{switch(s){case"open":return x;case"in_progress":return f;case"resolved":return g;case"closed":return h;default:return f}};return j?e.jsx("div",{children:"Loading support tickets..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Support Tickets"})}),e.jsx("div",{className:"grid gap-4",children:l.map(s=>(N(s.status),e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-6 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.subject}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y(s.status)}`,children:s.status.replace("_"," ")})]}),e.jsx("p",{className:"text-gray-600",children:s.message}),e.jsxs("div",{className:"text-sm text-gray-500",children:["From: ",s.user.name," (",s.user.email,")"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[s.status!=="resolved"&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>a(s.id,"in_progress"),children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"In Progress"]}),s.status!=="closed"&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>a(s.id,"resolved"),children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Resolve"]}),s.status!=="closed"&&e.jsxs(o,{size:"sm",variant:"destructive",onClick:()=>a(s.id,"closed"),children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Close"]})]})]})},s.id)))})]})};export{z as default};
