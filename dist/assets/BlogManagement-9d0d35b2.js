import{c as P,r as m,a as w,s as l,j as s,B as d,m as v}from"./index-f1002576.js";import{U}from"./user-plus-a1070bf4.js";import{K as S}from"./key-d4a8a2a1.js";import{P as N}from"./pen-square-492384b0.js";import{T as E}from"./trash-2-3d7382ac.js";import{B as k}from"./building-910cbb1e.js";import{M as B}from"./map-pin-d1c3bb7e.js";import{I as b}from"./image-81fff18b.js";import{F as C}from"./file-text-3254db3b.js";import{E as M}from"./eye-879892a0.js";const z=P("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),O=()=>{const[n,o]=m.useState([]),[h,p]=m.useState(!0),{toast:r}=w();m.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:e,error:t}=await l.from("users").select("*").order("created_at",{ascending:!1});if(t)throw t;o(e),p(!1)}catch{r({variant:"destructive",title:"Error",description:"Failed to load users"}),p(!1)}},f=async e=>{try{const{data:t,error:a}=await l.auth.admin.createUser({email:e.email,password:e.password,email_confirm:!0});if(a)throw a;const{data:i,error:c}=await l.from("users").insert([{id:t.user.id,email:e.email,name:e.name,role:e.role}]).select().single();if(c)throw c;o([i,...n]),r({title:"Success",description:"User created successfully"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}},u=async(e,t)=>{try{const{data:a,error:i}=await l.from("users").update(t).eq("id",e).select().single();if(i)throw i;o(n.map(c=>c.id===e?a:c)),r({title:"Success",description:"User updated successfully"})}catch(a){r({variant:"destructive",title:"Error",description:a.message})}},g=async e=>{try{const{error:t}=await l.from("users").delete().eq("id",e);if(t)throw t;o(n.filter(a=>a.id!==e)),r({title:"Success",description:"User deleted successfully"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}},y=async e=>{try{const{error:t}=await l.auth.resetPasswordForEmail(e);if(t)throw t;r({title:"Success",description:"Password reset email sent"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}};return h?s.jsx("div",{children:"Loading users..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"User Management"}),s.jsxs(d,{onClick:()=>f({email:"new@example.com",password:"temppass123",name:"New User",role:"tenant"}),children:[s.jsx(U,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),s.jsx("div",{className:"grid gap-4",children:n.map(e=>s.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-4 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:e.name}),s.jsx("p",{className:"text-sm text-gray-600",children:e.email}),s.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full",children:e.role})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(d,{size:"sm",variant:"outline",onClick:()=>y(e.email),children:s.jsx(S,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"outline",onClick:()=>u(e.id,{...e,name:`${e.name} (Updated)`}),children:s.jsx(N,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"destructive",onClick:()=>g(e.id),children:s.jsx(E,{className:"h-4 w-4"})})]})]})},e.id))})]})},R=()=>{const[n,o]=m.useState([]),[h,p]=m.useState(!0),{toast:r}=w();m.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:e,error:t}=await l.from("properties").select(`
          *,
          landlord:landlord_id(name),
          agent:agent_id(name)
        `).order("created_at",{ascending:!1});if(t)throw t;o(e),p(!1)}catch{r({variant:"destructive",title:"Error",description:"Failed to load properties"}),p(!1)}},f=async e=>{try{const{data:t,error:a}=await l.from("properties").insert([e]).select().single();if(a)throw a;o([t,...n]),r({title:"Success",description:"Property created successfully"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}},u=async(e,t)=>{try{const{data:a,error:i}=await l.from("properties").update(t).eq("id",e).select().single();if(i)throw i;o(n.map(c=>c.id===e?a:c)),r({title:"Success",description:"Property updated successfully"})}catch(a){r({variant:"destructive",title:"Error",description:a.message})}},g=async e=>{try{const{error:t}=await l.from("properties").delete().eq("id",e);if(t)throw t;o(n.filter(a=>a.id!==e)),r({title:"Success",description:"Property deleted successfully"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}},y=async(e,t)=>{try{const a=t.name.split(".").pop(),i=`${e}/${Date.now()}.${a}`,{error:c}=await l.storage.from("property-images").upload(i,t);if(c)throw c;const{data:j}=l.storage.from("property-images").getPublicUrl(i);await u(e,{images:l.postgres.arr_append("images",j.publicUrl)}),r({title:"Success",description:"Image uploaded successfully"})}catch(a){r({variant:"destructive",title:"Error",description:a.message})}};return h?s.jsx("div",{children:"Loading properties..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Property Management"}),s.jsxs(d,{onClick:()=>f({name:"New Property",address:"123 Main St",type:"Apartment",status:"available"}),children:[s.jsx(k,{className:"h-4 w-4 mr-2"}),"Add Property"]})]}),s.jsx("div",{className:"grid gap-4",children:n.map(e=>s.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-4 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx(B,{className:"h-4 w-4 inline mr-1"}),e.address]}),s.jsxs("div",{className:"flex space-x-2 mt-2",children:[s.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full",children:e.type}),s.jsx("span",{className:"text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full",children:e.status})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(d,{size:"sm",variant:"outline",onClick:()=>{const t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=a=>{var i;(i=a.target.files)!=null&&i[0]&&y(e.id,a.target.files[0])},t.click()},children:s.jsx(b,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"outline",onClick:()=>u(e.id,{...e,name:`${e.name} (Updated)`}),children:s.jsx(N,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"destructive",onClick:()=>g(e.id),children:s.jsx(E,{className:"h-4 w-4"})})]})]})},e.id))})]})},W=()=>{const[n,o]=m.useState([]),[h,p]=m.useState(!0),{toast:r}=w();m.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:e,error:t}=await l.from("blogs").select(`
          *,
          author:author_id(name)
        `).order("created_at",{ascending:!1});if(t)throw t;o(e),p(!1)}catch{r({variant:"destructive",title:"Error",description:"Failed to load blogs"}),p(!1)}},f=async e=>{try{const{data:t,error:a}=await l.from("blogs").insert([e]).select().single();if(a)throw a;o([t,...n]),r({title:"Success",description:"Blog post created successfully"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}},u=async(e,t)=>{try{const{data:a,error:i}=await l.from("blogs").update(t).eq("id",e).select().single();if(i)throw i;o(n.map(c=>c.id===e?a:c)),r({title:"Success",description:"Blog post updated successfully"})}catch(a){r({variant:"destructive",title:"Error",description:a.message})}},g=async e=>{try{const{error:t}=await l.from("blogs").delete().eq("id",e);if(t)throw t;o(n.filter(a=>a.id!==e)),r({title:"Success",description:"Blog post deleted successfully"})}catch(t){r({variant:"destructive",title:"Error",description:t.message})}},y=async(e,t)=>{try{const a=t.name.split(".").pop(),i=`${e}/${Date.now()}.${a}`,{error:c}=await l.storage.from("blog-images").upload(i,t);if(c)throw c;const{data:j}=l.storage.from("blog-images").getPublicUrl(i);await u(e,{image:j.publicUrl}),r({title:"Success",description:"Image uploaded successfully"})}catch(a){r({variant:"destructive",title:"Error",description:a.message})}};return h?s.jsx("div",{children:"Loading blogs..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Blog Management"}),s.jsxs(d,{onClick:()=>f({title:"New Blog Post",content:"Write your content here...",published:!1}),children:[s.jsx(C,{className:"h-4 w-4 mr-2"}),"Add Blog Post"]})]}),s.jsx("div",{className:"grid gap-4",children:n.map(e=>{var t;return s.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-4 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:e.title}),s.jsxs("p",{className:"text-sm text-gray-600",children:["By ",(t=e.author)==null?void 0:t.name]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${e.published?"bg-green-100 text-green-600":"bg-yellow-100 text-yellow-600"}`,children:e.published?"Published":"Draft"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(d,{size:"sm",variant:"outline",onClick:()=>{const a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=i=>{var c;(c=i.target.files)!=null&&c[0]&&y(e.id,i.target.files[0])},a.click()},children:s.jsx(b,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"outline",onClick:()=>u(e.id,{...e,published:!e.published}),children:e.published?s.jsx(z,{className:"h-4 w-4"}):s.jsx(M,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"outline",onClick:()=>u(e.id,{...e,title:`${e.title} (Updated)`}),children:s.jsx(N,{className:"h-4 w-4"})}),s.jsx(d,{size:"sm",variant:"destructive",onClick:()=>g(e.id),children:s.jsx(E,{className:"h-4 w-4"})})]})]})},e.id)})})]})};export{W as B,R as P,O as U};
