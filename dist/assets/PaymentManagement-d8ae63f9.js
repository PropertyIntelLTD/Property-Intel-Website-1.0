import{r as d,a as v,s as u,j as e,m as r,B as j}from"./index-f1002576.js";import{F as b}from"./filter-67bfe49d.js";import{D as w}from"./dollar-sign-8db84bf7.js";import{C as P}from"./check-circle-811f6759.js";import{C}from"./calendar-077122ec.js";import{A as S}from"./alert-circle-bcb9e97e.js";import{f as M}from"./index-c4405eea.js";const O=()=>{const[l,o]=d.useState([]),[y,m]=d.useState(!0),[i,g]=d.useState("all"),{toast:c}=v();d.useEffect(()=>{f()},[i]);const f=async()=>{try{let t=u.from("payments").select(`
          *,
          tenant:tenant_id(name),
          property:property_id(name)
        `).order("due_date",{ascending:!1});i!=="all"&&(t=t.eq("status",i));const{data:a,error:s}=await t;if(s)throw s;o(a),m(!1)}catch{c({variant:"destructive",title:"Error",description:"Failed to load payments"}),m(!1)}},x=async(t,a)=>{try{const{data:s,error:p}=await u.from("payments").update({status:a}).eq("id",t).select().single();if(p)throw p;o(l.map(h=>h.id===t?s:h)),c({title:"Success",description:"Payment status updated successfully"})}catch(s){c({variant:"destructive",title:"Error",description:s.message})}},N=t=>{switch(t){case"paid":return"bg-green-100 text-green-600";case"pending":return"bg-yellow-100 text-yellow-600";case"overdue":return"bg-red-100 text-red-600";default:return"bg-gray-100 text-gray-600"}};if(y)return e.jsx("div",{children:"Loading payments..."});const n={total:l.reduce((t,a)=>t+a.amount,0),paid:l.filter(t=>t.status==="paid").length,pending:l.filter(t=>t.status==="pending").length,overdue:l.filter(t=>t.status==="overdue").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Payment Management"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-4 w-4 text-gray-500"}),e.jsxs("select",{value:i,onChange:t=>g(t.target.value),className:"border rounded-md px-2 py-1",children:[e.jsx("option",{value:"all",children:"All Payments"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx(w,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",n.total]})]}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx(P,{className:"h-8 w-8 text-green-500 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Paid"}),e.jsx("p",{className:"text-2xl font-bold",children:n.paid})]}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx(C,{className:"h-8 w-8 text-yellow-500 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold",children:n.pending})]}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx(S,{className:"h-8 w-8 text-red-500 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold",children:n.overdue})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-4",children:"Tenant"}),e.jsx("th",{className:"text-left p-4",children:"Property"}),e.jsx("th",{className:"text-left p-4",children:"Amount"}),e.jsx("th",{className:"text-left p-4",children:"Due Date"}),e.jsx("th",{className:"text-left p-4",children:"Status"}),e.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(t=>{var a,s;return e.jsxs(r.tr,{initial:{opacity:0},animate:{opacity:1},className:"border-b",children:[e.jsx("td",{className:"p-4",children:(a=t.tenant)==null?void 0:a.name}),e.jsx("td",{className:"p-4",children:(s=t.property)==null?void 0:s.name}),e.jsxs("td",{className:"p-4",children:["$",t.amount]}),e.jsx("td",{className:"p-4",children:M(new Date(t.due_date),"MMM d, yyyy")}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${N(t.status)}`,children:t.status})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex space-x-2",children:[t.status!=="paid"&&e.jsx(j,{size:"sm",variant:"outline",onClick:()=>x(t.id,"paid"),children:"Mark Paid"}),t.status==="pending"&&e.jsx(j,{size:"sm",variant:"destructive",onClick:()=>x(t.id,"overdue"),children:"Mark Overdue"})]})})]},t.id)})})]})})})]})};export{O as default};
