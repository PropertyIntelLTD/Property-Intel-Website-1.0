import{c as S,r as n,a as C,s as k,j as e,B as M,m as T}from"./index-f1002576.js";import{S as E}from"./search-304ed518.js";import{F as D}from"./filter-67bfe49d.js";import{A as d}from"./alert-circle-bcb9e97e.js";import{C as u}from"./clock-5934541c.js";import{f as m}from"./index-c4405eea.js";const F=S("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),B=()=>{const[i,j]=n.useState([]),[f,x]=n.useState(!0),[c,g]=n.useState("all"),[t,v]=n.useState(""),{toast:w}=C();n.useEffect(()=>{N()},[c,t]);const N=async()=>{try{let s=k.from("system_logs").select(`
          *,
          user:user_id(name)
        `).order("created_at",{ascending:!1});c!=="all"&&(s=s.eq("type",c)),t&&(s=s.ilike("description",`%${t}%`));const{data:a,error:l}=await s;if(l)throw l;j(a),x(!1)}catch{w({variant:"destructive",title:"Error",description:"Failed to load system logs"}),x(!1)}},p=s=>{switch(s){case"error":return"bg-red-100 text-red-600";case"warning":return"bg-yellow-100 text-yellow-600";case"info":return"bg-blue-100 text-blue-600";case"success":return"bg-green-100 text-green-600";default:return"bg-gray-100 text-gray-600"}},b=()=>{const s=i.map(o=>{var h;return[m(new Date(o.created_at),"yyyy-MM-dd HH:mm:ss"),o.type,((h=o.user)==null?void 0:h.name)||"System",o.description].join(",")}),l=[["Timestamp,Type,User,Description"].join(","),...s].join(`
`),L=new Blob([l],{type:"text/csv"}),y=window.URL.createObjectURL(L),r=document.createElement("a");r.href=y,r.download=`system-logs-${m(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(y)};return f?e.jsx("div",{children:"Loading system logs..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"System Logs"}),e.jsxs(M,{onClick:b,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Export Logs"]})]}),e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(E,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:t,onChange:s=>v(s.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("select",{value:c,onChange:s=>g(s.target.value),className:"border rounded-md px-2 py-2",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"error",children:"Errors"}),e.jsx("option",{value:"warning",children:"Warnings"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"success",children:"Success"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[i.map(s=>{var a;return e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-4 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:`p-2 rounded-full ${p(s.type)}`,children:[s.type==="error"&&e.jsx(d,{className:"h-4 w-4"}),s.type==="warning"&&e.jsx(d,{className:"h-4 w-4"}),s.type==="info"&&e.jsx(u,{className:"h-4 w-4"}),s.type==="success"&&e.jsx(u,{className:"h-4 w-4"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[e.jsx("span",{children:((a=s.user)==null?void 0:a.name)||"System"}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:m(new Date(s.created_at),"MMM d, yyyy 'at' h:mm a")})]})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p(s.type)}`,children:s.type})]})},s.id)}),i.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg",children:[e.jsx(d,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"No Logs Found"}),e.jsx("p",{className:"text-gray-500 mt-2",children:t?"Try adjusting your search terms":"System logs will appear here"})]})]})]})};export{B as default};
